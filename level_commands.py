# level_commands.py
# ãƒ¬ãƒ™ãƒ«é–¢é€£ã®Slash Commandã‚’å®šç¾©ï¼ˆä¸è¦ã‚³ãƒãƒ³ãƒ‰å‰Šé™¤æ¸ˆã¿ï¼‰

import discord
from discord import app_commands
from discord.ext import commands
import firebase_admin
from firebase_admin import firestore

db = None

def get_db():
    global db
    if db is None:
        db = firestore.client()
    return db

class LevelCommands(commands.Cog):
    def __init__(self, bot):
        self.bot = bot
    
    @app_commands.command(name="xpã‚¬ã‚¤ãƒ‰", description="çµŒé¨“å€¤ã‚·ã‚¹ãƒ†ãƒ ã«ã¤ã„ã¦ã®èª¬æ˜ã‚’è¡¨ç¤ºã—ã¾ã™")
    async def xp_guide(self, interaction: discord.Interaction):
        """çµŒé¨“å€¤ç²å¾—æ–¹æ³•ã¨ãƒ¬ãƒ™ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã«ã¤ã„ã¦ã®ã‚¬ã‚¤ãƒ‰ã‚’è¡¨ç¤ºã—ã¾ã™"""
        await interaction.response.defer()
        
        embed = discord.Embed(
            title="âœ¨ XPç²å¾—ã‚¬ã‚¤ãƒ‰",
            description="KRAFTã§ã®çµŒé¨“å€¤(XP)ç²å¾—æ–¹æ³•ã¨ä»•çµ„ã¿ã«ã¤ã„ã¦ã®èª¬æ˜ã§ã™ã€‚",
            color=discord.Color.blurple()
        )
        
        embed.add_field(
            name="ğŸ“ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æŠ•ç¨¿",
            value=(
                "â€¢ åŸºæœ¬: 1æŠ•ç¨¿ã«ã¤ã **10 XP**\n"
                "â€¢ é•·æ–‡ãƒœãƒ¼ãƒŠã‚¹: 15æ–‡å­—ã”ã¨ã« **+1 XP** (æœ€å¤§ **+20 XP**)\n"
                "â€¢ é€£ç¶šæŠ•ç¨¿: 1æ—¥ã«10å›ä»¥ä¸Šã§ **+20 XP**\n"
                "â€¢ ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³: 30ç§’é–“éš”ã§XPç²å¾—å¯èƒ½\n"
            ),
            inline=False
        )
        
        embed.add_field(
            name="ğŸ¯ ã‚¯ã‚¨ã‚¹ãƒˆé”æˆ",
            value=(
                "â€¢ é€±é–“ã‚¯ã‚¨ã‚¹ãƒˆ: **200 XP**\n"
                "â€¢ æœˆé–“ã‚¯ã‚¨ã‚¹ãƒˆ: **600 XP**\n"
                "â€¢ å¹´é–“ã‚¯ã‚¨ã‚¹ãƒˆ: **2000 XP**\n"
                "â€¢ é€£ç¶šé”æˆ: 3å›é€£ç¶šé”æˆã§ **+200 XP**\n"
                "â€¢ æ—©æœŸé”æˆãƒœãƒ¼ãƒŠã‚¹: æœŸæ—¥å‰é”æˆã§ **+30%**\n"
            ),
            inline=False
        )
        
        embed.add_field(
            name="ğŸ’° ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£è²¢çŒ®",
            value=(
                "â€¢ å¯„ä»˜: 100KRã«ã¤ã **10 XP**\n"
                "â€¢ é€é‡‘: 100KRã«ã¤ã **5 XP**\n"
                "â€¢ æ³¨: ã“ã‚Œã‚‰ã¯æ—¥æ¬¡ä¸Šé™ã®å¯¾è±¡å¤–\n"
            ),
            inline=False
        )
        
        embed.add_field(
            name="ğŸ”„ ãƒœãƒ¼ãƒŠã‚¹ã‚¿ã‚¤ãƒ ",
            value=(
                "â€¢ æœˆåˆ/æœˆæœ«: æœˆã®åˆæ—¥ãƒ»æœ€çµ‚æ—¥ã®5æ—¥é–“ã¯ **2å€ XP**\n"
                "â€¢ ç§°å·ãƒœãƒ¼ãƒŠã‚¹: ç§°å·ã«ã‚ˆã£ã¦ **è¿½åŠ XP**\n"
                "â€¢ é€£ç¶šæŠ•ç¨¿: 1æ—¥10å›ä»¥ä¸Šã®æŠ•ç¨¿ã§ **+20 XP**\n"
            ),
            inline=False
        )
        
        embed.add_field(
            name="ğŸ“Š æ—¥æ¬¡XPä¸Šé™",
            value=(
                "ãƒ¬ãƒ™ãƒ«1-10: **1,000 XP/æ—¥**\n"
                "ãƒ¬ãƒ™ãƒ«11-30: **2,000 XP/æ—¥**\n"
                "ãƒ¬ãƒ™ãƒ«31-60: **3,000 XP/æ—¥**\n"
                "ãƒ¬ãƒ™ãƒ«61+: **4,000 XP/æ—¥**\n"
                "â€»ã‚¯ã‚¨ã‚¹ãƒˆé”æˆã¯ä¸Šé™å¯¾è±¡å¤–\n"
            ),
            inline=False
        )
        
        embed.add_field(
            name="ğŸ… ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ç§°å·",
            value=(
                "ãƒ¬ãƒ™ãƒ«1: `å‰å¤§ãªã‚‹ä¸€æ­©`\n"
                "ãƒ¬ãƒ™ãƒ«5: `æ–°äººå†’é™ºè€…` - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸XP +5%\n"
                "ãƒ¬ãƒ™ãƒ«10: `å†’é™ºè€…` - æ—¥æ¬¡XPä¸Šé™ +5%\n"
                "ãƒ¬ãƒ™ãƒ«20: `ç†Ÿç·´å†’é™ºè€…` - ã‚¯ã‚¨ã‚¹ãƒˆXP +5%\n"
                "ãƒ¬ãƒ™ãƒ«30: `æ¢æ±‚è€…` - é€é‡‘XP +10%\n"
                "ãƒ¬ãƒ™ãƒ«50: `é”äºº` - ã™ã¹ã¦ã®XP +5%\n"
                "ãƒ¬ãƒ™ãƒ«100: `ç”Ÿãã‚‹ä¼èª¬` - ã™ã¹ã¦ã®XP +15%\n"
            ),
            inline=False
        )
        
        embed.add_field(
            name="ğŸ’¡ åŠ¹ç‡çš„ãªãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã®ã‚³ãƒ„",
            value=(
                "â€¢ æ¯æ—¥ã‚³ãƒ³ã‚¹ã‚¿ãƒ³ãƒˆã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æŠ•ç¨¿\n"
                "â€¢ ã‚¯ã‚¨ã‚¹ãƒˆã‚’ç©æ¥µçš„ã«è¨­å®šãƒ»é”æˆ\n"
                "â€¢ æœˆåˆãƒ»æœˆæœ«ã®2å€æœŸé–“ã‚’æ´»ç”¨\n"
                "â€¢ é•·æ–‡æŠ•ç¨¿ã§ãƒœãƒ¼ãƒŠã‚¹XPã‚’ç‹™ã†\n"
                "â€¢ ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£è²¢çŒ®ï¼ˆå¯„ä»˜ãƒ»é€é‡‘ï¼‰ã‚‚æœ‰åŠ¹\n"
            ),
            inline=False
        )
        
        embed.set_footer(text="è©³ç´°ãªæƒ…å ±ã¯ /ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ« ã§ç¢ºèªã§ãã¾ã™")
        
        await interaction.followup.send(embed=embed)

# Botã¸ã®ç™»éŒ²é–¢æ•°
def setup(bot):
    bot.add_cog(LevelCommands(bot))